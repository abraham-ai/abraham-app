type Creation @entity(immutable: false) {
  id: ID! # session UUID
  messageCount: Int!
  firstMessageAt: BigInt!
  lastActivityAt: BigInt!
  ethSpent: BigInt!
  closed: Boolean! # true when closed (no blessings/praises allowed)
  messages: [Message!]! @derivedFrom(field: "creation")
}

type Message @entity(immutable: false) {
  id: ID! # "${sessionId}-${messageId}"
  creation: Creation!
  uuid: String! # message UUID
  author: Bytes!
  content: String! # may be empty string if Abraham posted media-only
  media: String # nullable; null when no media
  timestamp: BigInt!
  praiseCount: Int!
  praises: [Praise!]! @derivedFrom(field: "message")
}

type Praise @entity(immutable: true) {
  id: ID! # "${messageId}-${txHash}-${logIdx}"
  message: Message!
  praiser: Bytes!
  timestamp: BigInt!
}

type User @entity(immutable: false) {
  id: ID!
  praisesGiven: Int!
  praisesReceived: Int!
}
