# schema.graphql
type Creation @entity(immutable: false) {
  id: ID! # session UUID
  messageCount: Int!
  firstMessageAt: BigInt!
  lastActivityAt: BigInt!
  ethSpent: BigInt! # total Wei spent on blessings + praises (user costs)
  closed: Boolean! # true ⇒ no blessings/praises allowed
  messages: [Message!]! @derivedFrom(field: "creation")
}

type Message @entity(immutable: false) {
  id: ID! # "${sessionId}-${messageId}"
  creation: Creation!
  uuid: String! # original per-session message UUID
  author: Bytes!
  content: String! # may be an empty string for media-only owner posts
  media: String # nullable; null ⇒ no media
  timestamp: BigInt!
  praiseCount: Int!
  praises: [Praise!]! @derivedFrom(field: "message")
}

type Praise @entity(immutable: true) {
  id: ID! # "${sessionId}-${messageId}-${txHash}-${logIdx}"
  message: Message!
  praiser: Bytes!
  timestamp: BigInt!
}

type User @entity(immutable: false) {
  id: ID! # address
  praisesGiven: Int!
  praisesReceived: Int!
}
